# ExpectingPassingYardsMetricNFL
NFL Expected Passing Yards Metric


## Introduction
This project uses machine learning algorithms to analyze the NFL Big Data Bowl 2022 dataset to measure the chance of converting a play into a first down or touchdown. The dataset provides detailed information about every play in every game of the first 8 weeks of the 2021 NFL season. 

The study demonstrates the value of using advanced analytical methods to extract insights from complex and diverse data sources in the field of sports analytics. The findings have implications for coaches and players to optimize their playcalling and strategy.


## Data
Dataset: https://www.kaggle.com/competitions/nfl-big-data-bowl-2023

This project focuses on the NFL Big Data Bowl 2022 dataset, which includes granular frame data capturing player movement and positioning on the field for each play. The data is preprocessed into play-by-play data and relevant features are selected to predict play outcomes, including player and team performance metrics, game context variables, and play type indicators. Various machine learning algorithms are used to build models that predict the probability of a team converting a first down or scoring a touchdown. The preprocessing pipeline includes aggregating frame data into summary statistics, encoding categorical variables, and calculating new features.	

## Exploratory Data Analysis


First, I will examine the impact of offensive formation on the result of offensive plays in the NFL. Findings suggest that offensive formation does not have a large impact on play result over the course of a season. Specifically, we found that the Empty Formation had a mean of 6.56 yards gained on play and a standard deviation of 9.86. The Shotgun Formation, which was the most common formation in the dataset, had a mean of 6.26 yards gained on play and a standard deviation of 9.9. The Singleback Formation had a mean of 7.66 yards gained on a play, but a larger standard deviation of 11.49.

Second, I decided to look into how defensive pass coverage affects play results. The analysis suggests that pass coverage played by the defense does not have a large impact on play results over the course of a season. The most common play types used in order are Cover-3, Cover-1, and Cover-2 with Quarters a close fourth. Among these common coverages, the difference in mean between the largest mean yards gained and the smallest mean yards gained is about 0.2 yards. This indicates that pass coverage does not have a significant impact on yards gained on play. In addition, I found that the standard deviations for yards gained on play for each coverage type were relatively large (ranging from 9.5 yards to 11.5 yards), indicating significant variation in play results within each coverage type. The 2-Man coverage gives up the most yards on average (only 194 plays) but also has the largest standard deviation at 12.45 yards. This suggests that other factors, such as the specific play called or the skill of the individual players involved, may have a larger impact on play results than pass coverage alone. It also makes sense that the red zone plays have the lowest average yards gained because the offensive team is close to the goal line and the range of available yards to gain is low.

I then decided to look into the breakdown of yardage gained by both defensive pass coverage and offensive formation. The most interesting tidbit is the disparity in average yards gained in Cover-2 defensive formation. With an ‘Empty’ (no RBs lined up in the backfield) offensive formation, the mean yards gained is right under 6 yards per play but for ‘Singleback’ (one RB lined up in the backfield with QB) formation, the mean yards gained is 8.6 - a difference of 43%. Of course, the standard deviation for the ‘Empty’ formation is significantly lower than the standard deviation for the ‘Singleback’ formation.

Next, I wanted to look at the impact the number of defenders in the box has on the number of yards gained on average. Interesting to note that more than 5 defenders in the box leads to higher average yards gained but also leads to higher standard deviation. But the most interesting point is the likelihood of gaining a first down or score increases as there are more defenders in the box. This could be explained due to more defenders in the box would mean fewer defenders in coverage of the receivers.
	
In order to gain a better understanding of the relationship between pass coverage and the success rate of plays, I looked at the frequency of each type of coverage used by defenses and their corresponding success rates in converting plays into first downs or touchdowns.

Excluding Prevent coverage, which is typically used in end-of-game situations to prevent long passes, I found that most coverages have similar success rates at scale. Among the most commonly used coverages, Cover-6 had the highest success rate at 13.7%, followed closely by Cover-3 at 12.8%. On the other hand, Prevent and 2-Man were the least effective at converting plays, both with a success rate below 10%.

Offensive Formation had a significant impact on the success rates of plays. The I-Form and Jumbo formation (albeit at a lower scale) had a success rate of over 17%, while the Pistol formation (easily the worst of the bunch) had a success rate below 10% at 8.9%. This finding suggests that offensive formation plays an important role in determining the outcome of a play, with certain formations being more successful than others. It is possible that some formations may provide better opportunities for the offense to make plays, while others may be more predictable and easier for the defense to defend against. This analysis shows the importance of offensive linemen for play outcomes as well. The I-Form and Jumbo formation are plays where the offensive line is heavily huddled to the QB and usually used in redzone or short yrdage situations. It is important to note that this analysis only provides a high-level overview of the relationship between offensive formation and play success. Further analysis is necessary to understand the underlying factors driving these trends and to determine whether other variables are also important predictors of play success.

Then, I wanted to dig into the breakdown of the position lined up for players that caught the ball. The analysis revealed that players lined up in the slot (left or right) caught the most number of passes, whereas WRs, TEs, and FBs lined up outside caught the least amount of passes. This finding could be attributed to several reasons, such as the ability of the QB to throw between the numbers more easily, or the fact that players lined up outside might be marked by better defenders. However, I was surprised to see such a high disparity between the number of passes caught by players in different positions.

After further research, the observation that slot receivers caught the most number of passes is consistent with the current trends in the NFL, where teams are increasingly using spread offenses and rely on shorter, quicker passes. Additionally, slot receivers typically have favorable matchups against linebackers or slot cornerbacks, which could also contribute to their higher catch rate. On the other hand, the lower number of passes caught by receivers lining up outside could be due to various reasons, including tougher matchups against cornerbacks, more difficult routes, or simply fewer opportunities due to game situations and play calling.

As I was exploring trends within plays where the player caught the ball and found that the type of QB movement during the play had a significant impact on the success rates of plays. Specifically, when the QB had a designed rollout to the left or right side, the percentage of plays that led to a first down or score was notably higher than traditional dropbacks or scrambles. The success rates for designed rollouts were 18.4% for the left and 20.7% for the right, compared to 12.8% for traditional dropbacks and below 10% for scrambles. Suggesting that QB movement during a play can have a meaningful impact on the success of the play. Designed rollouts may provide an advantage by changing the angle of the throw and creating more space for the receivers to work with. On the other hand, scrambles may be more difficult to execute successfully due to the unpredictable nature of the play.
Another possible explanation could be that the rollouts allow the QB to have a better view of the field and create more space for the receiver to get open. The lower success rate for scrambles could be due to the fact that it's a more improvised play and requires the QB to make split-second decisions. It would be worth further investigation to see if these trends hold up across multiple seasons, teams, and QBs, and whether they can be used to inform play-calling and game strategy.

Another metric I look at was the number of catch-eligible receivers and the success rate of the play. It's definitely possible that the number of catch-eligible receivers on a play is related to the success rate of the play. It could be that having more receivers increases the options for the quarterback and makes it harder for the defense to defend against, but at the same time, it may also require more precise timing and execution. Conversely, having fewer receivers may make it easier for the defense to anticipate the play, but may also allow for quicker, more efficient execution. 
Also, it could be possible that the decrease in success rate with an increase in catch-eligible receivers could be due to the additional yardage required to gain a first down or score. It could also be related to the fact that with more receivers eligible to catch the ball, there are more defenders to cover them, making it more difficult to complete a pass. Another factor could be the complexity of the play design or the ability of the QB to read the defense and make the right decision with multiple options for receivers. 
It would be interesting to further explore this relationship and possibly control for other factors such as defensive formations or offensive strategies.

The breakdown of successful pass attempts by down with the 0th down counting as 2-PT conversion attempts.  This is a very interesting finding! It's not necessarily intuitive that plays run on 4th down would have a higher success rate than those run on 3rd down, but it's possible that teams are more willing to take risks on when running plays on 4th down. It's also intriguing that plays run on 2nd down have the highest success rate, which may indicate that teams are able to catch the defense off guard more often on that down. This information could be useful for teams when deciding on play-calling strategies in different situations. It is worth further exploration as to why this is the case, as it could provide insights into offensive strategies or defensive weaknesses during specific downs.

I break down the success rate by the quarter of play. It's interesting to see the variation in success rates across different quarters of the game. The higher success rate in overtime could be due to the higher stakes and pressure, leading to more focused and efficient play calling. It's possible that the success rates are influenced by factors such as game situation, fatigue levels, and defensive adjustments made by the opposing team throughout the course of the game, which is what led to the lower success rates in the 2nd and 4th quarters. It would be worthwhile to further explore these trends and potential factors that contribute to success rates across different quarters of the game.


Additionally, pass coverage type appears to have a slight impact on the success rate of achieving a first down or touchdown. The success rate for achieving a first down or touchdown against man coverage is 10.7%, while the success rate against zone coverage is slightly higher at 12.6%. Interestingly, the success rate against "other" coverage types is slightly lower at 10.4%. However, it's important to note that this analysis only takes into account the impact of pass coverage type and doesn't consider other factors that may also influence the success rate, such as offensive formation, drop-back type, defenders in the box, and receiver route. 

## Modeling

I used 3 different ML models for this dataset:
- Logistic Regression Classification
- Random Forest Classifier
- K-Nearest Neighbors

I split the data into 3 groupings based number of eligible receivers.

3-Receiver Sets:
Based on the given data for 3-eligible receiver sets, it is difficult to determine which model is the best since all three models have relatively low accuracy, precision, and recall. However, if we had to choose, we can eliminate the Random Forest model since it has a precision and recall of 0, indicating that it did not correctly identify any positive cases.  Between the Logistic Regression and KNN models, the KNN model has a slightly higher precision and recall than the Logistic Regression model. Therefore, we can consider the KNN model to be the better choice for predicting whether a first down or touchdown will occur in 3-eligible receiver sets. However, it's important to note that the overall performance of these models is not ideal, and further exploration and feature engineering may be necessary to improve the model's accuracy.

4-Receiver Sets:
Based on the data for 4-eligible receiver sets, the best model is Random Forest. It has the highest accuracy at 0.62, and a precision score of 1.00 indicates that the model has correctly predicted all true positives, which is an important metric for predicting successful plays. However, the recall score of 0.01 is very low, which means the model may have missed a large number of actual successful plays. The Random Forest model still outperforms the other two models, Logistic Regression and KNN, in terms of accuracy and precision. But, the Logistic Regression model is only slightly behind on accuracy but has a much better recall, even though it’s not a great recall.

5-Receiver Sets:
Based on the data below, it is difficult to determine the best model for 5-eligible receiver sets. However, it appears that Random Forest has the highest precision score of 0.5, meaning it correctly identified 50% of the first downs achieved by the offense. The precision score for Logistic Regression is 0.00, indicating that the model did not correctly identify any of the first downs achieved by the offense. The KNN model has a precision score of 0.31, which is lower than the Random Forest model. However, the recall score for all three models is very low, indicating that they are not very effective at identifying all instances of first downs achieved by the offense. While the accuracy score is the same across all 3 models.

## Conclusion

Based on the metrics provided, it seems that the Random Forest model performed the best overall for the 3 datasets. It had the highest accuracy and precision for the 4-receiver set, the highest accuracy and recall for the 3-receiver set, and the highest precision and recall for the 5-receiver set.
The Logistic Regression model had poor performance across all three datasets, with low precision and recall scores. The KNN model had the highest precision for the 3-receiver set, but overall its performance was also relatively poor compared to the Random Forest model.

Therefore, based on the provided data, it appears that the Random Forest model is the best model for predicting the success of passing plays with different eligible receiver sets. However, it is important to note that additional evaluation metrics and analysis may be needed to fully understand the strengths and weaknesses of each model.


